«Набор инструментов» Long War
Создатель: Long War Studios

Модификация XCOM, добавляющая дополнительные игровые возможности, которые можно активировать из меню при прохождении кампании, а также несколько улучшений для повышения удобства.

РУКОВОДСТВО ПО УСТАНОВКЕ 
Мастерская Steam: подпишитесь на модификацию на странице Long War Studios.

Nexus/вручную: скопируйте папку LW_Toolbox со всем ее содержимым из zip-архива в C:\Program Files (x86)\Steam\steamapps\common\XCOM 2\XComGame\Mods.

Чтобы играть:
Включите модификацию LW_Toolbox в программе запуска. 

Модификация автоматически вносит несколько изменений в интерфейс выбора отряда:

ИЗЪЯТЬ ВСЕ ОРУЖИЕ: изымает основное оружие у всех солдат, не задействованных в текущем задании.

ОЧИСТИТЬ ОТРЯД: убирает всех солдат из отряда.

СОБРАТЬ ОТРЯД АВТОМАТИЧЕСКИ: заполняет свободные места в отряде солдатами самого высокого звания.

Кроме того, интерфейс списка солдат теперь отображает их параметры.

Все дополнительные параметры можно выбрать на закладке «Набор инструментов» в меню настроек (обычно открывается при нажатии клавиши Escape). Начав кампанию, откройте меню и выберите «ИЗМЕНИТЬ НАСТРОЙКИ», затем выберите «НАБОР ИНСТРУМЕНТОВ LW». ВНИМАНИЕ: Настройки доступны только из кампании.

Доступны следующие параметры:

УГОЛ ВРАЩЕНИЯ КАМЕРЫ (В ГРАДУСАХ): позволяет игроку контролировать величину поворота камеры при помощи кнопок поворота и горячих клавиш.

НАЧАЛЬНЫЙ РАЗМЕР ОТРЯДА: позволяет выбрать максимальное число солдат в отряде. Бонус от партизанской школы может увеличить это значение. Интерфейс и код высадки теперь поддерживает отряды до 12 человек. ВНИМАНИЕ: модификация не меняет баланс игры при увеличении размера отряда.

РУССКАЯ РУЛЕТКА: позволяет настроить разброс наносимого урона (солдатами и пришельцами) в виде процента от базового значения. Отключив режим, вы вернете базовые механики игры. 25% означают, что урон будет варьироваться в пределах +/- 25% от базового урона оружия. Функционал замещает настройки конкретных видов оружия.

ВСЕ ЛЮДИ РАЗНЫЕ: случайным образом изменяет базовые параметры солдат, действует мгновенно (даже в процессе задания). Отключение функции возвращает базовые значения. Случайные значения запоминаются, поэтому включение и выключение не позволяет добиться преимущества. Функцию можно активировать в режиме глобуса либо в течение первого хода задания, если никто не получил ранения (изменение параметров может привести к гибели раненого солдата, если его здоровье уменьшится).

СКРЫТЫЙ ПОТЕНЦИАЛ: случайным образом повышает параметры, когда солдат получает уровень. Внимание: особые «секретные» солдаты не подвержены этому эффекту.

«КРАСНЫЙ ТУМАН»: включает функцию, при которой ранения влияют на параметры меткости, мобильности, взлома и воли. Игрок может выбрать, кого это коснется: ХСОМ, пришельцев, всех или никого. Некоторые пришельцы (определяется в LW_Toolbox.ini) не подвержены этому влиянию, поскольку иначе они стали бы неэффективными.

ЛИНЕЙНЫЕ ШТРАФЫ «КРАСНОГО ТУМАНА» (ВМЕСТО КВАДРАТИЧНЫХ): базовое воздействие «красного тумана» снижает параметры таким образом, что легкие ранения имеют незначительный эффект, а тяжелые - более серьезный. Линейная зависимость приводит к тому, что легкие/средние ранения дают куда большие штрафы, чем при квадратичной формуле.

АВТОРАСЧЕТ БОЯ: добавляет в интерфейс выбора отряда кнопку, которая позволяет автоматически рассчитать результат сражения для текущего отряда без запуска задания.

---------------------------------------------
------------------АВТОРЫ---------------------
---------------------------------------------

Технический директор: Рейчел «Amineri» Норман
Программист: Джонатан «tracktwo» Эммет
Ведущий дизайнер: Джон Лампкин

---------------------------------------------
----------------РАЗРЕШЕНИЯ-------------------
---------------------------------------------

Создатели модификаций могут использовать любой код и материалы дополнения в собственных работах при указании авторства Long War Studios.

---------------------------------------------
---------------СОВМЕСТИМОСТЬ-----------------
---------------------------------------------

Классы, замененные этой модификацией (ожидается проблема совместимости с модификациями, заменяющими эти же классы):
- XComTacticalInput
- UIOptionsPCScreen
- UISquadSelect
- UIAfterAction
- X2TacticalGameRuleset
- UIPersonnel_SquadSelect
- UIPersonnel_SoldierListItem
- UIRecruitmentListItem

Примечание:
- XComTacticalInput
Используется для настройки углов поворота камеры.

- UIOptionsPCScreen
Используется для настроек модификации в процессе игры. 
Другие модификации могут использовать этот интерфейс, создав расширение класса XComGameState_LWModOptions и вызвав CreateModSettingsState, чтобы добавить его в CampaignSettings.

- UISquadSelect
- UIAfterAction
Используется для больших интерфейсов отрядов.
Добавлены следующие обработчики событий (hooks), чтобы другие модификации смогли поддержать изменения.
	-- TriggerEvent('OnValidateDeployableSoldiers', DeployableSoldiersTuple, self); // позволяет модификациям удалять солдат, неспособных отправиться на текущее задание
	-- TriggerEvent('PostSquadSelectInit', XComHQ, self);	// позволяет модификациям вносить изменения после инициализации SquadSelect
	-- TriggerEvent('OnUpdateSquadSelectSoldiers', XComHQ, XComHQ, NewGameState)  // позволяет модификациям добавлять/удалять солдат в процессе инициализации SquadSelect
	-- TriggerEvent('OnUpdateSquadSelect_ListItem', self, self)   // вызывается из UISquadSelect_ListItem_LW.Update, позволяет добавлять объекты в отдельные пункты списка

- X2TacticalGameRuleset
Используется для расширения зоны высадки сверх базовой сетки 3х3, поддерживающейся кодом игры.

- UIPersonnel_SquadSelect
- UIPersonnel_SoldierListItem
- UIRecruitmentListItem
Используется для отображения параметров солдат при просмотре/найме
Добавлены следующие обработчики событий (hooks), чтобы другие модификации смогли поддержать изменения.
	-- TriggerEvent('OnSoldierListItemUpdate_Start', self, self);  // вызывается из UIPersonnel_SoldierListItem_LW.Update, позволяет обновлять фоновые элементы
	-- TriggerEvent('OnSoldierListItemUpdate_End', self, self);  // вызывается из UIPersonnel_SoldierListItem_LW.Update, позволяет размещать новые слои интерфейса поверх текущих элементов
	-- TriggerEvent('OnSoldierListItemUpdate_Focussed', self, self);  // вызывается из UIPersonnel_SoldierListItem_LW.UpdateItemsForFocus, позволяет изменять пункты списка вне зависимости от фокуса
	-- TriggerEvent('OnSoldierListItem_GetPersonnelStatus', self, self); // вызывается из UIPersonnel_SoldierListItem_LW.GetPersonnelStatusSeparateWrapper, позволяет переопределять статус персонала
	-- TriggerEvent('OnRecruitmentListItemInit', self, self);   // вызывается из UIRecruitmentListItem_LW.InitRecruitItem, позволяет добавлять дополнительные элементы
	-- TriggerEvent('OnRecruitmentListItemUpdateFocus', self, self);  // вызывается из UIRecruitmentListItem_LW.UpdateItemsForFocus, позволяет обновлять элементы, когда выбран пункт списка
	-- TriggerEvent('OnSoldierListItemUpdateDisabled', UnitItem, self); // вызывается из UIPersonnel_SquadSelect.UpdateList, позволяет переопределять недоступное состояние пункта списка 

Эта модификация вносит изменения в шаблоны X2StrategyElement_DefaultRewards: 'Reward_Soldier', 'Reward_Rookie' и 'Reward_CouncilSoldier'.
Переопределяет делегирование GenerateRewardFn во всех трех случаях; совместимость с другими модификациями, вносящими схожие изменения, отсутствует.
Новые функции добавляют следующие обработчики событий (hooks), которыми может пользоваться «Набор инструментов» и другие модификации:
	-- TriggerEvent( 'SoldierCreatedEvent', NewUnitState, NewUnitState, NewGameState );  // позволяет перехватывать контроль над созданными солдатами, чтобы внести изменения. Это не касается солдат, созданных в самом начале кампании
	-- TriggerEvent( 'RankUpEvent', NewUnitState, NewUnitState, NewGameState );   // позволяет перехватывать контроль над повышением звания при создании солдат в награду. Используется вместе с 'PromotionEvent' и 'PsiTrainingCompleted', чтобы перехватывать все подобные события.

---------------------------------------------
---------ЗАМЕТКИ ДЛЯ РАЗРАБОТЧИКОВ-----------
---------------------------------------------

Другие модификации могут использовать обход UIOptionsPCScreen, используемый в «Наборе инструментов» LW, чтобы задавать собственные игровые настройки. Каждая такая модификация добавит новую закладку в меню настроек. Список можно прокручивать в случае, если большое количество модификаций воспользуются этим методом.

Как подключить вашу модификацию к «Набору инструментов» LW:

1) Скопируйте файл класса XComGameState_LWModOptions.uc в свою модификацию, в отдельную папку внутри /Src/LW_XCGS_ModOptions/Classes/
2) Добавьте строку "+ModEditPackages=LW_XCGS_ModOptions" (указание новой папки в Src) в файл XComEngine.ini, раздел [UnrealEd.EditorEngine]
3) Создайте расширение XComGameState_LWModOptions, чтобы создать собственные настройки на основе примера, приведенного в XComGameState_LWToolboxOptions
4) В расширении X2DownloadableContentInfo добавьте вызовы CreateModSettingsState на основе примера в X2DownloadableContentInfo_LWToolbox
5) «Набор инструментов» LW (если он присутствует) найдет состояние ModOptions и автоматически добавит настройки в игру

Заметки касательно имплементации расширения XComGameState_LWModOptions:
Новая папка Src (LW_XCGS_ModOptions) приведет к тому, что в папку скриптов вашей модификации будет скомпилирован второй файл LW_XCGS_ModOptions.u. Это нормально и позволяет компоненту ModOptions и коду действовать в отсутствие «Набора инструментов» LW. Модификацию, имплементирующую интерфейс, можно установить ДО «Набора инструментов» LW. Тогда настройки станут активными только после его установки.

-- InitComponent() :
 Место для желаемой инициализации. Обратите внимание: это случается только при первом создании состояния игры и не обновляется при обновлении кода/модификаций.

 -- GetTabText() : 
Подставляет текст для отображения в UIOptionsPCScreen. Желательно хотя бы локализовать.

-- InitModOptions() : 
Этот метод используется при каждом создании/инициализации UIOptionsPCScreen. Позволяет кэшировать текущие настройки и все остальное, что должно произойти в этот момент.

-- SetModOptionsEnabled() : 
Основной интерфейс между ModOptions и UIOptionsPCScreen. Передает массив UIMechaItem для заполнения ModOptions, который потом отображает UIOptionsPCScreen.

-- HasAnyValueChanged() : 
Запрашивает ModOptions об изменении настроек. Используется для предупреждения при выходе из UIOptionsPCScreen без сохранения изменений.

-- ApplyModSettings() : 
Используется при выборе «Сохранить и выйти». Запрашивает ModOptions о применении ранее выбранных пользователем настроек.

-- RestorePreviousModSettings() : 
Используется при выходе в обход «Сохранить и выйти». ModOptions возвращает настройки к состоянию на момент, когда игрок попал в UIOptionsPCScreen.

-- CanResetModSettings() : 
Запрос, определяет ли модификация настройки по умолчанию. Используется для создания кнопки «Сбросить настройки модификаций». По умолчанию - «false»; если не трогать эту настройку, то сброс будет недоступен.

-- ResetModSettings() : 
Обратный вызов от кнопки «Сбросить настройки модификаций» при сбросе текущей закладки на значения по умолчанию. Не должен сохранять настройки (это происходит при выборе «Сохранить и выйти»). Может быть вызван только в случае, если CanResetModSettings() возвращает «true».

--------------------------------------------------

ДОПОЛНИТЕЛЬНО:

«Набор инструментов» использует базовую структуру данных LW_Tuple для передачи данных при помощи X2EventManager. Если ваша модификация хочет выполнить RegisterForEvent для какого-то EventID, вам придется включить пакет LW_Tuple:

1) Скопируйте файл класса LWTuple.uc в свою модификацию, в отдельную папку внутри Src/LW_Tuple/Classes/
2) Добавьте строку "+ModEditPackages=LW_Tuple" (указание новой папки в Src) в файл XComEngine.ini, раздел [UnrealEd.EditorEngine]
3) Используйте класс LWTuple в своем коде
